import{r as j,m as T,j as e,L as O,$ as w}from"./app-DD1_j264.js";import{B}from"./badge-PeB8ie60.js";import{B as u}from"./createLucideIcon-CJXjctMu.js";import{C as p,a as f,b,c as M,d as L}from"./card-DMpxeHKD.js";import{C as _}from"./checkbox-CmdZUS2u.js";import{I as D}from"./input-cZgy-9z1.js";import{T as H,a as q,b as h,c as l,d as A,e as n}from"./table-Bx2kdRqw.js";import{A as E,t as Q}from"./app-layout-BjO8UPhY.js";import"./index-CR58GS18.js";import"./index-Db2yqOI4.js";import"./index-D6cg2Mm3.js";import"./app-logo-DcjKhG5i.js";import"./pill-BS0WEZWH.js";function Y({medicationsToReorder:x}){const[c,i]=j.useState({}),[o,C]=j.useState(new Set),{setData:g,post:S,processing:m}=T({medications:[]}),k=r=>{C(t=>{const s=new Set(t);return s.has(r)?(s.delete(r),i(a=>{const d={...a};return delete d[r],d})):(s.add(r),i(a=>({...a,[r]:1}))),s})},N=(r,t)=>{i(s=>({...s,[r]:t}))},v=r=>x[r].reduce((t,s)=>t+(c[s.id]||0),0),y=r=>{r.preventDefault();const t=Object.entries(c).filter(([,s])=>s>0).map(([s,a])=>({id:parseInt(s,10),quantity:a}));if(t.length===0){Q.error("Please select at least one medication and set a quantity greater than 0.");return}g("medications",t),S(route("manager.orders.store"))};return e.jsxs(E,{breadcrumbs:[{title:"Orders",href:"/manager/orders"},{title:"Create",href:"/manager/orders/create"}],children:[e.jsx(O,{title:"Create Stock Order"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsx(p,{className:"rounded-none",children:e.jsxs(f,{children:[e.jsx(b,{children:"Create Stock Order"}),e.jsx(M,{children:"Select medications to order from suppliers."})]})}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[Object.entries(x).map(([r,t])=>e.jsxs(p,{className:"rounded-none",children:[e.jsx(f,{children:e.jsx(b,{children:r})}),e.jsx(L,{children:e.jsxs(H,{children:[e.jsx(q,{className:"[&_tr]:border-0",children:e.jsxs(h,{children:[e.jsx(l,{className:"w-12",children:"Select"}),e.jsx(l,{children:"Medication"}),e.jsx(l,{children:"Schedule"}),e.jsx(l,{children:"Current Stock"}),e.jsx(l,{children:"Reorder Level"}),e.jsx(l,{className:"w-32",children:"Order Quantity"})]})}),e.jsxs(A,{children:[t.map(s=>{var a;return e.jsxs(h,{className:"border-0",children:[e.jsx(n,{children:e.jsx(_,{checked:o.has(s.id),onCheckedChange:()=>k(s.id)})}),e.jsxs(n,{className:"font-medium",children:[e.jsx("div",{children:s.name}),e.jsx("div",{className:"text-muted-foreground text-xs",children:((a=s.supplier)==null?void 0:a.name)??r})]}),e.jsx(n,{children:e.jsx(B,{variant:"outline",children:s.schedule})}),e.jsx(n,{children:s.quantity_on_hand}),e.jsx(n,{children:s.reorder_level}),e.jsx(n,{children:e.jsx(D,{type:"number",min:"1",disabled:!o.has(s.id),onChange:d=>N(s.id,parseInt(d.target.value,10)||0),value:c[s.id]||"",className:"w-20",placeholder:"1"})})]},s.id)}),e.jsxs(h,{className:"border-0",children:[e.jsx(n,{colSpan:5,className:"text-right font-semibold",children:"Total Items:"}),e.jsx(n,{className:"font-semibold",children:v(r)})]})]})]})})]},r)),e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx(w,{href:route("manager.orders.index"),children:e.jsx(u,{variant:"outline",children:"Cancel"})}),e.jsx(u,{type:"submit",disabled:m||o.size===0,children:m?"Creating Order...":"Create Stock Order"})]})]})]})]})}export{Y as default};
