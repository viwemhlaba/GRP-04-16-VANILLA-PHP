import{r as d,m as se,K as re,j as e,L as ae,$ as n}from"./app-DD1_j264.js";import{B as te}from"./badge-PeB8ie60.js";import{a as N,B as o}from"./createLucideIcon-CJXjctMu.js";import{C as _,d as b,a as T,b as F}from"./card-DMpxeHKD.js";import{D as ie,a as le,b as ne,c as ce}from"./dialog-BWut1jda.js";import{t as g,A as de,v as E,w as I,x as O,y as t,z as $}from"./app-layout-BjO8UPhY.js";import{I as z}from"./input-cZgy-9z1.js";import{T as B,a as H,b as f,c as r,d as R,e as a}from"./table-Bx2kdRqw.js";import{D}from"./download-C1qKmiEZ.js";import{E as V}from"./eye-xYu3NAbP.js";import{P as U}from"./package-ZoGHK-yM.js";import"./index-D6cg2Mm3.js";import"./index-CR58GS18.js";import"./app-logo-DcjKhG5i.js";import"./pill-BS0WEZWH.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],q=N("Ellipsis",oe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],xe=N("Loader",he);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],pe=N("SquarePen",me);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],G=N("Trash",ue),K=h=>{const w={pending:"bg-yellow-100 text-yellow-800 hover:bg-yellow-200",approved:"bg-blue-100 text-blue-800 hover:bg-blue-200",dispensed:"bg-green-100 text-green-800 hover:bg-green-200",rejected:"bg-red-100 text-red-800 hover:bg-red-200"};return e.jsx(te,{className:w[h]||"bg-gray-100 text-gray-800",children:h.charAt(0).toUpperCase()+h.slice(1)})};function Se({uploadedPrescriptions:h,manualPrescriptions:w}){const[J,x]=d.useState(!1),[c,k]=d.useState(null),[l,Q]=d.useState(""),[m,W]=d.useState(""),[p,X]=d.useState(""),{delete:Y,processing:M}=se(),{flash:i}=re().props;d.useEffect(()=>{i!=null&&i.success&&g.success(i.success),i!=null&&i.error&&g.error(i.error)},[i]);const L=s=>{k(s),x(!0)},Z=()=>{if(!c)return;const s=c.is_manual?route("pharmacist.prescriptions.manual.destroy",c.id):route("pharmacist.prescriptions.destroy",c.id);Y(s,{onSuccess:()=>{g.success("Prescription deleted."),x(!1),k(null)},onError:()=>{g.error("Failed to delete prescription."),x(!1)}})},P=h.filter(s=>{var u,j;const y=(((u=s.prescription_name)==null?void 0:u.toLowerCase().includes(l.toLowerCase()))??!1)||s.status.toLowerCase().includes(l.toLowerCase())||(((j=s.customer_name)==null?void 0:j.toLowerCase().includes(l.toLowerCase()))??!1),v=m?s.status===m:!0,C=p?new Date(s.upload_date).toISOString().slice(0,10)===p:!0;return y&&v&&C}),S=w.filter(s=>{var u,j,A;const y=(((u=s.prescription_name)==null?void 0:u.toLowerCase().includes(l.toLowerCase()))??!1)||s.status.toLowerCase().includes(l.toLowerCase())||(((j=s.customer_name)==null?void 0:j.toLowerCase().includes(l.toLowerCase()))??!1)||(((A=s.doctor_name)==null?void 0:A.toLowerCase().includes(l.toLowerCase()))??!1),v=m?s.status===m:!0,C=p?new Date(s.created_date).toISOString().slice(0,10)===p:!0;return y&&v&&C}),ee=[{title:"Prescriptions",href:route("pharmacist.prescriptions.index")}];return e.jsxs(de,{breadcrumbs:ee,children:[e.jsx(ae,{title:"Prescriptions"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"Prescriptions"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"View uploaded and manually created prescriptions."})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(o,{variant:"outline",asChild:!0,children:e.jsx(n,{href:route("pharmacist.customers.create"),children:"Create Customer"})}),e.jsx(o,{asChild:!0,children:e.jsx(n,{href:route("pharmacist.prescriptions.createManual"),children:"Create Manual Prescription"})})]})]}),e.jsx(_,{className:"rounded-none",children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"grid max-w-5xl grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsx(z,{type:"text",placeholder:"Search by prescription, customer, doctor or status...",value:l,onChange:s=>Q(s.target.value)}),e.jsxs("select",{className:"rounded-md border px-3 py-2 text-sm text-gray-800 dark:border-gray-700 dark:bg-gray-900 dark:text-white",value:m,onChange:s=>W(s.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"dispensed",children:"Dispensed"})]}),e.jsx(z,{type:"date",value:p,onChange:s=>X(s.target.value)})]})})}),e.jsxs(_,{className:"rounded-none",children:[e.jsx(T,{className:"pb-2",children:e.jsx(F,{className:"text-lg font-medium",children:"Uploaded Prescriptions"})}),e.jsx(b,{children:P.length===0?e.jsx("p",{className:"text-muted-foreground text-sm",children:"No matching uploaded prescriptions found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(B,{className:"w-full",children:[e.jsx(H,{className:"bg-gray-50 dark:bg-gray-900",children:e.jsxs(f,{children:[e.jsx(r,{children:"Customer"}),e.jsx(r,{children:"Prescription"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Date Uploaded"}),e.jsx(r,{children:"Delivery Method"}),e.jsx(r,{children:"Repeats"}),e.jsx(r,{children:"Actions"})]})}),e.jsx(R,{children:P.map(s=>e.jsxs(f,{children:[e.jsx(a,{children:s.customer_name||"N/A"}),e.jsx(a,{children:s.prescription_name||"N/A"}),e.jsx(a,{children:K(s.status)}),e.jsx(a,{children:new Date(s.upload_date).toLocaleString()}),e.jsxs(a,{className:"capitalize",children:[s.delivery_method==="pickup"&&"Pick up",s.delivery_method==="dispense"&&"Dispense",!s.delivery_method&&"Not specified"]}),e.jsx(a,{className:"space-y-1 text-sm",children:s.repeats_total>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[s.repeats_used," of ",s.repeats_total," used"]}),e.jsxs("div",{children:["Next: ",s.next_repeat_date??"N/A"]})]}):e.jsx("span",{className:"text-muted-foreground italic",children:"No repeats"})}),e.jsx(a,{children:e.jsxs(E,{children:[e.jsx(I,{asChild:!0,children:e.jsxs(o,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(q,{className:"h-4 w-4"})]})}),e.jsxs(O,{align:"end",children:[e.jsx(t,{asChild:!0,children:e.jsxs(n,{href:route("pharmacist.prescriptions.load",s.id),className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),"Load Prescription"]})}),e.jsx(t,{asChild:!0,children:e.jsxs("a",{href:`/storage/${s.file_path}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"Download"]})}),e.jsx(t,{asChild:!0,children:e.jsxs(n,{href:route("pharmacist.prescriptions.show",s.id),className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"View"]})}),s.status==="approved"&&s.repeats_used<s.repeats_total&&e.jsx(t,{asChild:!0,children:e.jsxs(n,{href:route("pharmacist.prescriptions.dispense.show",s.id),className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Dispense"]})}),e.jsx($,{}),e.jsxs(t,{onClick:()=>L(s),className:"flex items-center gap-2 text-red-600",children:[e.jsx(G,{className:"h-4 w-4"}),"Delete"]})]})]})})]},s.id))})]})})})]}),e.jsxs(_,{className:"rounded-none",children:[e.jsx(T,{className:"pb-2",children:e.jsx(F,{className:"text-lg font-medium",children:"Manual Prescriptions"})}),e.jsx(b,{children:S.length===0?e.jsx("p",{className:"text-muted-foreground text-sm",children:"No matching manual prescriptions found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(B,{className:"w-full",children:[e.jsx(H,{className:"bg-gray-50 dark:bg-gray-900",children:e.jsxs(f,{children:[e.jsx(r,{children:"Customer"}),e.jsx(r,{children:"Prescription"}),e.jsx(r,{children:"Doctor"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Date Created"}),e.jsx(r,{children:"Delivery Method"}),e.jsx(r,{children:"Repeats"}),e.jsx(r,{children:"Actions"})]})}),e.jsx(R,{children:S.map(s=>e.jsxs(f,{children:[e.jsx(a,{children:s.customer_name||"N/A"}),e.jsx(a,{children:s.prescription_name||"N/A"}),e.jsx(a,{children:s.doctor_name||"N/A"}),e.jsx(a,{children:K(s.status)}),e.jsx(a,{children:new Date(s.created_date).toLocaleString()}),e.jsxs(a,{className:"capitalize",children:[s.delivery_method==="pickup"&&"Pick up",s.delivery_method==="dispense"&&"Dispense",!s.delivery_method&&"Not specified"]}),e.jsx(a,{className:"space-y-1 text-sm",children:s.repeats_total>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[s.repeats_used," of ",s.repeats_total," used"]}),e.jsxs("div",{children:["Next: ",s.next_repeat_date??"N/A"]})]}):e.jsx("span",{className:"text-muted-foreground italic",children:"No repeats"})}),e.jsx(a,{children:e.jsxs(E,{children:[e.jsx(I,{asChild:!0,children:e.jsxs(o,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(q,{className:"h-4 w-4"})]})}),e.jsxs(O,{align:"end",children:[e.jsx(t,{asChild:!0,children:e.jsxs(n,{href:route("pharmacist.prescriptions.manual.edit",s.id),className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"Edit"]})}),s.file_path?e.jsx(t,{asChild:!0,children:e.jsxs("a",{href:`/storage/${s.file_path}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"Download PDF"]})}):e.jsx(t,{asChild:!0,children:e.jsxs("a",{href:route("pharmacist.prescriptions.manual.generatePdf",s.id),className:"flex items-center gap-2 text-green-600",target:"_blank",rel:"noopener noreferrer",download:!0,children:[e.jsx(D,{className:"h-4 w-4"}),"Generate PDF"]})}),e.jsx(t,{asChild:!0,children:e.jsxs(n,{href:route("pharmacist.prescriptions.show",s.id),className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"View"]})}),s.status==="approved"&&s.repeats_used<s.repeats_total&&e.jsx(t,{asChild:!0,children:e.jsxs(n,{href:route("pharmacist.prescriptions.dispense.show",s.id),className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Dispense"]})}),e.jsx($,{}),e.jsxs(t,{onClick:()=>L(s),className:"flex items-center gap-2 text-red-600",children:[e.jsx(G,{className:"h-4 w-4"}),"Delete"]})]})]})})]},s.id))})]})})})]}),e.jsx(ie,{open:J,onOpenChange:x,children:e.jsxs(le,{children:[e.jsx(ne,{children:e.jsx(ce,{children:"Confirm Delete"})}),e.jsxs("p",{children:['Are you sure you want to delete the prescription "',c==null?void 0:c.prescription_name,'"?']}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx(o,{variant:"outline",onClick:()=>x(!1),disabled:M,children:"Cancel"}),e.jsx(o,{variant:"destructive",onClick:Z,disabled:M,children:"Delete"})]})]})})]})]})}export{Se as default};
