import{r as c,j as e,S as f,L as _}from"./app-DD1_j264.js";import{B as h}from"./createLucideIcon-CJXjctMu.js";import{D as y,g as S,a as k,b,c as v}from"./dialog-BWut1jda.js";import{I as C}from"./input-cZgy-9z1.js";import{L as N}from"./label-D4qny3wm.js";import{t as j,A as q}from"./app-layout-BjO8UPhY.js";import{C as w,a as T,b as L,c as Q,d as A}from"./card-DMpxeHKD.js";import{C as I}from"./checkbox-CmdZUS2u.js";import{T as M,a as O,b as g,c as x,d as D,e as u}from"./table-Bx2kdRqw.js";import"./index-D6cg2Mm3.js";import"./index-CR58GS18.js";import"./app-logo-DcjKhG5i.js";import"./pill-BS0WEZWH.js";import"./index-Db2yqOI4.js";const E=({medicationId:t})=>{const[a,n]=c.useState(0),[i,r]=c.useState(""),[s,d]=c.useState(!1),m=()=>{if(a<=0){r("Quantity must be a positive number.");return}f.patch(`/manager/medications/${t}/add-stock`,{quantity:a},{onSuccess:()=>{d(!1),n(0),r(""),j.success("Stock quantity added successfully.")},onError:l=>{l.quantity?r(l.quantity):j.error("Failed to add stock.")}})},p=l=>{d(l),l||(n(0),r(""))};return e.jsxs(y,{open:s,onOpenChange:p,children:[e.jsx(S,{asChild:!0,children:e.jsx(h,{children:"Add Quantity"})}),e.jsxs(k,{children:[e.jsx(b,{children:e.jsx(v,{children:"Add Stock Quantity"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(N,{htmlFor:"quantity",className:"text-right",children:"Quantity to Add"}),e.jsx(C,{id:"quantity",type:"number",value:a,onChange:l=>n(parseInt(l.target.value,10)||0),className:"col-span-3"})]}),i&&e.jsx("p",{className:"col-span-4 text-right text-sm text-red-500",children:i})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(h,{onClick:m,children:"Add"})})]})]})},F=({medicationId:t,currentQuantity:a})=>{const[n,i]=c.useState(a),[r,s]=c.useState(""),[d,m]=c.useState(!1);c.useEffect(()=>{i(a)},[a]);const p=()=>{if(n<0){s("Quantity cannot be negative.");return}f.patch(`/manager/medications/${t}/set-stock`,{quantity:n},{onSuccess:()=>{m(!1),s(""),j.success("Stock quantity set successfully.")},onError:o=>{o.quantity?s(o.quantity):j.error("Failed to set stock.")}})},l=o=>{m(o),o||(i(a),s(""))};return e.jsxs(y,{open:d,onOpenChange:l,children:[e.jsx(S,{asChild:!0,children:e.jsx(h,{children:"Set Quantity"})}),e.jsxs(k,{children:[e.jsx(b,{children:e.jsx(v,{children:"Set Stock Quantity"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(N,{htmlFor:"quantity",className:"text-right",children:"Quantity"}),e.jsx(C,{id:"quantity",type:"number",value:n,onChange:o=>i(parseInt(o.target.value,10)||0),className:"col-span-3"})]}),r&&e.jsx("p",{className:"col-span-4 text-right text-sm text-red-500",children:r})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(h,{onClick:p,children:"Set"})})]})]})},Z=({medications:t})=>{const[a,n]=c.useState(!1),i=a?t.data.filter(s=>s.quantity_on_hand<=s.reorder_level):t.data,r=s=>{s&&(window.location.href=s)};return e.jsxs(q,{breadcrumbs:[{title:"Medications",href:"/manager/medications"},{title:"Stock",href:"/manager/medications/stock"}],children:[e.jsx(_,{title:"Stock Management"}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-6 rounded-xl p-6",children:e.jsxs(w,{className:"rounded-none",children:[e.jsxs(T,{children:[e.jsx(L,{children:"Medication Stock"}),e.jsx(Q,{children:"Manage medication stock levels."})]}),e.jsxs(A,{children:[e.jsxs("div",{className:"mb-4 flex items-center",children:[e.jsx(I,{id:"low-stock-filter",checked:a,onCheckedChange:s=>n(!!s),className:"mr-2"}),e.jsx("label",{htmlFor:"low-stock-filter",className:"text-sm leading-none font-medium peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Show only low stock items"})]}),e.jsxs(M,{children:[e.jsx(O,{children:e.jsxs(g,{children:[e.jsx(x,{children:"Name"}),e.jsx(x,{children:"Schedule"}),e.jsx(x,{children:"Quantity on Hand"}),e.jsx(x,{children:"Reorder Level"}),e.jsx(x,{className:"text-right",children:"Actions"})]})}),e.jsx(D,{children:i.map(s=>{const d=s.quantity_on_hand<=s.reorder_level;return e.jsxs(g,{className:d?"bg-red-100 dark:bg-red-900/50":"",children:[e.jsx(u,{children:s.name}),e.jsx(u,{children:s.schedule}),e.jsx(u,{children:s.quantity_on_hand}),e.jsx(u,{children:s.reorder_level}),e.jsxs(u,{className:"flex justify-end space-x-2 text-right",children:[e.jsx(F,{medicationId:s.id,currentQuantity:s.quantity_on_hand}),e.jsx(E,{medicationId:s.id})]})]},s.id)})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-muted-foreground text-sm",children:["Showing ",t.from," to ",t.to," of ",t.total," medications"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"outline",size:"sm",disabled:!t.prev_page_url,onClick:()=>r(t.prev_page_url),children:"Previous"}),e.jsxs("span",{children:["Page ",t.current_page," of ",t.last_page]}),e.jsx(h,{variant:"outline",size:"sm",disabled:!t.next_page_url,onClick:()=>r(t.next_page_url),children:"Next"})]})]})]})]})})]})};export{Z as default};
