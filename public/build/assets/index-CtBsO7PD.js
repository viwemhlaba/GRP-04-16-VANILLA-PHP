function j(){return j=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},j.apply(null,arguments)}var _=String.prototype.replace,L=/%20/g,M="RFC3986",E={default:M,formatters:{RFC1738:function(i){return _.call(i,L,"+")},RFC3986:function(i){return String(i)}},RFC1738:"RFC1738"},q=Object.prototype.hasOwnProperty,P=Array.isArray,O=function(){for(var i=[],e=0;e<256;++e)i.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return i}(),U=function(i,e){for(var t=e&&e.plainObjects?Object.create(null):{},r=0;r<i.length;++r)i[r]!==void 0&&(t[r]=i[r]);return t},S={arrayToObject:U,assign:function(i,e){return Object.keys(e).reduce(function(t,r){return t[r]=e[r],t},i)},combine:function(i,e){return[].concat(i,e)},compact:function(i){for(var e=[{obj:{o:i},prop:"o"}],t=[],r=0;r<e.length;++r)for(var s=e[r],o=s.obj[s.prop],n=Object.keys(o),u=0;u<n.length;++u){var l=n[u],y=o[l];typeof y=="object"&&y!==null&&t.indexOf(y)===-1&&(e.push({obj:o,prop:l}),t.push(y))}return function(h){for(;h.length>1;){var c=h.pop(),f=c.obj[c.prop];if(P(f)){for(var a=[],d=0;d<f.length;++d)f[d]!==void 0&&a.push(f[d]);c.obj[c.prop]=a}}}(e),i},decode:function(i,e,t){var r=i.replace(/\+/g," ");if(t==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},encode:function(i,e,t,r,s){if(i.length===0)return i;var o=i;if(typeof i=="symbol"?o=Symbol.prototype.toString.call(i):typeof i!="string"&&(o=String(i)),t==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(y){return"%26%23"+parseInt(y.slice(2),16)+"%3B"});for(var n="",u=0;u<o.length;++u){var l=o.charCodeAt(u);l===45||l===46||l===95||l===126||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||s===E.RFC1738&&(l===40||l===41)?n+=o.charAt(u):l<128?n+=O[l]:l<2048?n+=O[192|l>>6]+O[128|63&l]:l<55296||l>=57344?n+=O[224|l>>12]+O[128|l>>6&63]+O[128|63&l]:(l=65536+((1023&l)<<10|1023&o.charCodeAt(u+=1)),n+=O[240|l>>18]+O[128|l>>12&63]+O[128|l>>6&63]+O[128|63&l])}return n},isBuffer:function(i){return!(!i||typeof i!="object"||!(i.constructor&&i.constructor.isBuffer&&i.constructor.isBuffer(i)))},isRegExp:function(i){return Object.prototype.toString.call(i)==="[object RegExp]"},maybeMap:function(i,e){if(P(i)){for(var t=[],r=0;r<i.length;r+=1)t.push(e(i[r]));return t}return e(i)},merge:function i(e,t,r){if(!t)return e;if(typeof t!="object"){if(P(e))e.push(t);else{if(!e||typeof e!="object")return[e,t];(r&&(r.plainObjects||r.allowPrototypes)||!q.call(Object.prototype,t))&&(e[t]=!0)}return e}if(!e||typeof e!="object")return[e].concat(t);var s=e;return P(e)&&!P(t)&&(s=U(e,r)),P(e)&&P(t)?(t.forEach(function(o,n){if(q.call(e,n)){var u=e[n];u&&typeof u=="object"&&o&&typeof o=="object"?e[n]=i(u,o,r):e.push(o)}else e[n]=o}),e):Object.keys(t).reduce(function(o,n){var u=t[n];return o[n]=q.call(o,n)?i(o[n],u,r):u,o},s)}},G=Object.prototype.hasOwnProperty,B={brackets:function(i){return i+"[]"},comma:"comma",indices:function(i,e){return i+"["+e+"]"},repeat:function(i){return i}},N=Array.isArray,W=String.prototype.split,J=Array.prototype.push,V=function(i,e){J.apply(i,N(e)?e:[e])},K=Date.prototype.toISOString,T=E.default,v={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:S.encode,encodeValuesOnly:!1,format:T,formatter:E.formatters[T],indices:!1,serializeDate:function(i){return K.call(i)},skipNulls:!1,strictNullHandling:!1},X=function i(e,t,r,s,o,n,u,l,y,h,c,f,a,d){var m,p=e;if(typeof u=="function"?p=u(t,p):p instanceof Date?p=h(p):r==="comma"&&N(p)&&(p=S.maybeMap(p,function(R){return R instanceof Date?h(R):R})),p===null){if(s)return n&&!a?n(t,v.encoder,d,"key",c):t;p=""}if(typeof(m=p)=="string"||typeof m=="number"||typeof m=="boolean"||typeof m=="symbol"||typeof m=="bigint"||S.isBuffer(p)){if(n){var g=a?t:n(t,v.encoder,d,"key",c);if(r==="comma"&&a){for(var b=W.call(String(p),","),w="",$=0;$<b.length;++$)w+=($===0?"":",")+f(n(b[$],v.encoder,d,"value",c));return[f(g)+"="+w]}return[f(g)+"="+f(n(p,v.encoder,d,"value",c))]}return[f(t)+"="+f(String(p))]}var x,k=[];if(p===void 0)return k;if(r==="comma"&&N(p))x=[{value:p.length>0?p.join(",")||null:void 0}];else if(N(u))x=u;else{var Q=Object.keys(p);x=l?Q.sort(l):Q}for(var C=0;C<x.length;++C){var A=x[C],H=typeof A=="object"&&A.value!==void 0?A.value:p[A];if(!o||H!==null){var z=N(p)?typeof r=="function"?r(t,A):t:t+(y?"."+A:"["+A+"]");V(k,i(H,z,r,s,o,n,u,l,y,h,c,f,a,d))}}return k},I=Object.prototype.hasOwnProperty,Y=Array.isArray,D={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:S.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},ee=function(i){return i.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},Z=function(i,e){return i&&typeof i=="string"&&e.comma&&i.indexOf(",")>-1?i.split(","):i},te=function(i,e,t,r){if(i){var s=t.allowDots?i.replace(/\.([^.[]+)/g,"[$1]"):i,o=/(\[[^[\]]*])/g,n=t.depth>0&&/(\[[^[\]]*])/.exec(s),u=n?s.slice(0,n.index):s,l=[];if(u){if(!t.plainObjects&&I.call(Object.prototype,u)&&!t.allowPrototypes)return;l.push(u)}for(var y=0;t.depth>0&&(n=o.exec(s))!==null&&y<t.depth;){if(y+=1,!t.plainObjects&&I.call(Object.prototype,n[1].slice(1,-1))&&!t.allowPrototypes)return;l.push(n[1])}return n&&l.push("["+s.slice(n.index)+"]"),function(h,c,f,a){for(var d=a?c:Z(c,f),m=h.length-1;m>=0;--m){var p,g=h[m];if(g==="[]"&&f.parseArrays)p=[].concat(d);else{p=f.plainObjects?Object.create(null):{};var b=g.charAt(0)==="["&&g.charAt(g.length-1)==="]"?g.slice(1,-1):g,w=parseInt(b,10);f.parseArrays||b!==""?!isNaN(w)&&g!==b&&String(w)===b&&w>=0&&f.parseArrays&&w<=f.arrayLimit?(p=[])[w]=d:b!=="__proto__"&&(p[b]=d):p={0:d}}d=p}return d}(l,e,t,r)}},re=function(i,e){var t=function(y){return D}();if(i===""||i==null)return t.plainObjects?Object.create(null):{};for(var r=typeof i=="string"?function(y,h){var c,f={},a=(h.ignoreQueryPrefix?y.replace(/^\?/,""):y).split(h.delimiter,h.parameterLimit===1/0?void 0:h.parameterLimit),d=-1,m=h.charset;if(h.charsetSentinel)for(c=0;c<a.length;++c)a[c].indexOf("utf8=")===0&&(a[c]==="utf8=%E2%9C%93"?m="utf-8":a[c]==="utf8=%26%2310003%3B"&&(m="iso-8859-1"),d=c,c=a.length);for(c=0;c<a.length;++c)if(c!==d){var p,g,b=a[c],w=b.indexOf("]="),$=w===-1?b.indexOf("="):w+1;$===-1?(p=h.decoder(b,D.decoder,m,"key"),g=h.strictNullHandling?null:""):(p=h.decoder(b.slice(0,$),D.decoder,m,"key"),g=S.maybeMap(Z(b.slice($+1),h),function(x){return h.decoder(x,D.decoder,m,"value")})),g&&h.interpretNumericEntities&&m==="iso-8859-1"&&(g=ee(g)),b.indexOf("[]=")>-1&&(g=Y(g)?[g]:g),f[p]=I.call(f,p)?S.combine(f[p],g):g}return f}(i,t):i,s=t.plainObjects?Object.create(null):{},o=Object.keys(r),n=0;n<o.length;++n){var u=o[n],l=te(u,r[u],t,typeof i=="string");s=S.merge(s,l,t)}return S.compact(s)};class F{constructor(e,t,r){var s,o;this.name=e,this.definition=t,this.bindings=(s=t.bindings)!=null?s:{},this.wheres=(o=t.wheres)!=null?o:{},this.config=r}get template(){const e=`${this.origin}/${this.definition.uri}`.replace(/\/+$/,"");return e===""?"/":e}get origin(){return this.config.absolute?this.definition.domain?`${this.config.url.match(/^\w+:\/\//)[0]}${this.definition.domain}${this.config.port?`:${this.config.port}`:""}`:this.config.url:""}get parameterSegments(){var e,t;return(e=(t=this.template.match(/{[^}?]+\??}/g))==null?void 0:t.map(r=>({name:r.replace(/{|\??}/g,""),required:!/\?}$/.test(r)})))!=null?e:[]}matchesUrl(e){var t;if(!this.definition.methods.includes("GET"))return!1;const r=this.template.replace(/[.*+$()[\]]/g,"\\$&").replace(/(\/?){([^}?]*)(\??)}/g,(u,l,y,h)=>{var c;const f=`(?<${y}>${((c=this.wheres[y])==null?void 0:c.replace(/(^\^)|(\$$)/g,""))||"[^/?]+"})`;return h?`(${l}${f})?`:`${l}${f}`}).replace(/^\w+:\/\//,""),[s,o]=e.replace(/^\w+:\/\//,"").split("?"),n=(t=new RegExp(`^${r}/?$`).exec(s))!=null?t:new RegExp(`^${r}/?$`).exec(decodeURI(s));if(n){for(const u in n.groups)n.groups[u]=typeof n.groups[u]=="string"?decodeURIComponent(n.groups[u]):n.groups[u];return{params:n.groups,query:re(o)}}return!1}compile(e){return this.parameterSegments.length?this.template.replace(/{([^}?]+)(\??)}/g,(t,r,s)=>{var o,n;if(!s&&[null,void 0].includes(e[r]))throw new Error(`Ziggy error: '${r}' parameter is required for route '${this.name}'.`);if(this.wheres[r]&&!new RegExp(`^${s?`(${this.wheres[r]})?`:this.wheres[r]}$`).test((n=e[r])!=null?n:""))throw new Error(`Ziggy error: '${r}' parameter '${e[r]}' does not match required format '${this.wheres[r]}' for route '${this.name}'.`);return encodeURI((o=e[r])!=null?o:"").replace(/%7C/g,"|").replace(/%25/g,"%").replace(/\$/g,"%24")}).replace(this.config.absolute?/(\.[^/]+?)(\/\/)/:/(^)(\/\/)/,"$1/").replace(/\/+$/,""):this.template}}class ne extends String{constructor(e,t,r=!0,s){if(super(),this.t=s??(typeof Ziggy<"u"?Ziggy:globalThis==null?void 0:globalThis.Ziggy),this.t=j({},this.t,{absolute:r}),e){if(!this.t.routes[e])throw new Error(`Ziggy error: route '${e}' is not in the route list.`);this.i=new F(e,this.t.routes[e],this.t),this.u=this.l(t)}}toString(){const e=Object.keys(this.u).filter(t=>!this.i.parameterSegments.some(({name:r})=>r===t)).filter(t=>t!=="_query").reduce((t,r)=>j({},t,{[r]:this.u[r]}),{});return this.i.compile(this.u)+function(t,r){var s,o=t,n=function(a){if(!a)return v;if(a.encoder!=null&&typeof a.encoder!="function")throw new TypeError("Encoder has to be a function.");var d=a.charset||v.charset;if(a.charset!==void 0&&a.charset!=="utf-8"&&a.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var m=E.default;if(a.format!==void 0){if(!G.call(E.formatters,a.format))throw new TypeError("Unknown format option provided.");m=a.format}var p=E.formatters[m],g=v.filter;return(typeof a.filter=="function"||N(a.filter))&&(g=a.filter),{addQueryPrefix:typeof a.addQueryPrefix=="boolean"?a.addQueryPrefix:v.addQueryPrefix,allowDots:a.allowDots===void 0?v.allowDots:!!a.allowDots,charset:d,charsetSentinel:typeof a.charsetSentinel=="boolean"?a.charsetSentinel:v.charsetSentinel,delimiter:a.delimiter===void 0?v.delimiter:a.delimiter,encode:typeof a.encode=="boolean"?a.encode:v.encode,encoder:typeof a.encoder=="function"?a.encoder:v.encoder,encodeValuesOnly:typeof a.encodeValuesOnly=="boolean"?a.encodeValuesOnly:v.encodeValuesOnly,filter:g,format:m,formatter:p,serializeDate:typeof a.serializeDate=="function"?a.serializeDate:v.serializeDate,skipNulls:typeof a.skipNulls=="boolean"?a.skipNulls:v.skipNulls,sort:typeof a.sort=="function"?a.sort:null,strictNullHandling:typeof a.strictNullHandling=="boolean"?a.strictNullHandling:v.strictNullHandling}}(r);typeof n.filter=="function"?o=(0,n.filter)("",o):N(n.filter)&&(s=n.filter);var u=[];if(typeof o!="object"||o===null)return"";var l=B[r&&r.arrayFormat in B?r.arrayFormat:r&&"indices"in r?r.indices?"indices":"repeat":"indices"];s||(s=Object.keys(o)),n.sort&&s.sort(n.sort);for(var y=0;y<s.length;++y){var h=s[y];n.skipNulls&&o[h]===null||V(u,X(o[h],h,l,n.strictNullHandling,n.skipNulls,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset))}var c=u.join(n.delimiter),f=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(f+=n.charset==="iso-8859-1"?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),c.length>0?f+c:""}(j({},e,this.u._query),{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0,encoder:(t,r)=>typeof t=="boolean"?Number(t):r(t)})}p(e){e?this.t.absolute&&e.startsWith("/")&&(e=this.h().host+e):e=this.v();let t={};const[r,s]=Object.entries(this.t.routes).find(([o,n])=>t=new F(o,n,this.t).matchesUrl(e))||[void 0,void 0];return j({name:r},t,{route:s})}v(){const{host:e,pathname:t,search:r}=this.h();return(this.t.absolute?e+t:t.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"))+r}current(e,t){const{name:r,params:s,query:o,route:n}=this.p();if(!e)return r;const u=new RegExp(`^${e.replace(/\./g,"\\.").replace(/\*/g,".*")}$`).test(r);if([null,void 0].includes(t)||!u)return u;const l=new F(r,n,this.t);t=this.l(t,l);const y=j({},s,o);if(Object.values(t).every(c=>!c)&&!Object.values(y).some(c=>c!==void 0))return!0;const h=(c,f)=>Object.entries(c).every(([a,d])=>Array.isArray(d)&&Array.isArray(f[a])?d.every(m=>f[a].includes(m)):typeof d=="object"&&typeof f[a]=="object"&&d!==null&&f[a]!==null?h(d,f[a]):f[a]==d);return h(t,y)}h(){var e,t,r,s,o,n;const{host:u="",pathname:l="",search:y=""}=typeof window<"u"?window.location:{};return{host:(e=(t=this.t.location)==null?void 0:t.host)!=null?e:u,pathname:(r=(s=this.t.location)==null?void 0:s.pathname)!=null?r:l,search:(o=(n=this.t.location)==null?void 0:n.search)!=null?o:y}}get params(){const{params:e,query:t}=this.p();return j({},e,t)}get routeParams(){return this.p().params}get queryParams(){return this.p().query}has(e){return this.t.routes.hasOwnProperty(e)}l(e={},t=this.i){e!=null||(e={}),e=["string","number"].includes(typeof e)?[e]:e;const r=t.parameterSegments.filter(({name:s})=>!this.t.defaults[s]);return Array.isArray(e)?e=e.reduce((s,o,n)=>j({},s,r[n]?{[r[n].name]:o}:typeof o=="object"?o:{[o]:""}),{}):r.length!==1||e[r[0].name]||!e.hasOwnProperty(Object.values(t.bindings)[0])&&!e.hasOwnProperty("id")||(e={[r[0].name]:e}),j({},this.m(t),this.j(e,t))}m(e){return e.parameterSegments.filter(({name:t})=>this.t.defaults[t]).reduce((t,{name:r},s)=>j({},t,{[r]:this.t.defaults[r]}),{})}j(e,{bindings:t,parameterSegments:r}){return Object.entries(e).reduce((s,[o,n])=>{if(!n||typeof n!="object"||Array.isArray(n)||!r.some(({name:u})=>u===o))return j({},s,{[o]:n});if(!n.hasOwnProperty(t[o])){if(!n.hasOwnProperty("id"))throw new Error(`Ziggy error: object passed as '${o}' parameter is missing route model binding key '${t[o]}'.`);t[o]="id"}return j({},s,{[o]:n[t[o]]})},{})}valueOf(){return this.toString()}}function ie(i,e,t,r){const s=new ne(i,e,t,r);return i?s.toString():s}export{ie as T};
